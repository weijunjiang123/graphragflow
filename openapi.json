{"openapi":"3.1.0","info":{"title":"GraphRAG Q&A API","description":"Intelligent Question Answering with Graph-enhanced Retrieval Augmented Generation","version":"1.0.0"},"paths":{"/api/conversations":{"post":{"tags":["chat"],"summary":"Create Chat Response","description":"Create a chat response using GraphRAG\n\nTakes conversation history and generates a response using graph-enhanced retrieval.","operationId":"create_chat_response_api_conversations_post","parameters":[{"name":"max_context_length","in":"query","required":false,"schema":{"type":"integer","default":4000,"title":"Max Context Length"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatResponse"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/conversations/async":{"post":{"tags":["chat"],"summary":"Create Chat Response Async","description":"Create an asynchronous chat response\n\nStarts a chat response task in the background and returns a task ID for polling.","operationId":"create_chat_response_async_api_conversations_async_post","parameters":[{"name":"max_context_length","in":"query","required":false,"schema":{"type":"integer","default":4000,"title":"Max Context Length"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChatRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AsyncTaskResponse"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/conversations/async/{task_id}":{"get":{"tags":["chat"],"summary":"Get Async Chat Result","description":"Get the result of an asynchronous chat task\n\nReturns the result if the task is complete, or the current status if it's still processing.","operationId":"get_async_chat_result_api_conversations_async__task_id__get","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Get Async Chat Result Api Conversations Async  Task Id  Get"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/documents":{"post":{"tags":["knowledge"],"summary":"Upload Document","description":"Upload a document to build the knowledge graph\n\nTakes a document file and processes it to extract entities and relationships.\nThe processing occurs asynchronously in the background.","operationId":"upload_document_api_documents_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_upload_document_api_documents_post"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GraphTaskResponse"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["knowledge"],"summary":"Reset Knowledge Graph","description":"Reset the knowledge graph\n\nDeletes all documents, entities, and relationships from the knowledge graph.\nUse with caution as this operation cannot be undone.","operationId":"reset_knowledge_graph_api_documents_delete","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Reset Knowledge Graph Api Documents Delete"}}}},"404":{"description":"Not found"}}}},"/api/documents/tasks/{task_id}":{"get":{"tags":["knowledge"],"summary":"Get Document Processing Status","description":"Get the status of a document processing task\n\nReturns the current status or result of a previously submitted document processing task.","operationId":"get_document_processing_status_api_documents_tasks__task_id__get","parameters":[{"name":"task_id","in":"path","required":true,"schema":{"type":"string","title":"Task Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Get Document Processing Status Api Documents Tasks  Task Id  Get"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/documents/stats":{"get":{"tags":["knowledge"],"summary":"Get Knowledge Graph Stats","description":"Get statistics about the knowledge graph\n\nReturns counts of documents, entities, and relationships in the knowledge graph.","operationId":"get_knowledge_graph_stats_api_documents_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DocumentStats"}}}},"404":{"description":"Not found"}}}},"/api/graph-query/text2cypher":{"post":{"tags":["graph-query"],"summary":"将自然语言转换为Cypher查询并执行","description":"将自然语言查询转换为Cypher查询并执行\n\n- **query**: 自然语言查询，例如\"查找所有Person节点的名字\"\n- **return_direct**: 是否直接返回数据库结果，而不经过LLM解释\n- **top_k**: 返回结果的最大数量\n\n返回:\n- **query**: 原始自然语言查询\n- **generated_cypher**: 生成的Cypher查询\n- **raw_results**: 数据库查询结果\n- **result**: LLM解释的结果\n- **entities**: 提取的实体列表\n- **metadata**: 查询元数据","operationId":"text_to_cypher_api_graph_query_text2cypher_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/Text2CypherRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Text To Cypher Api Graph Query Text2Cypher Post"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/graph-query/execute-cypher":{"post":{"tags":["graph-query"],"summary":"直接执行Cypher查询","description":"直接执行Cypher查询\n\n- **cypher_query**: Cypher查询语句\n\n返回:\n- **results**: 查询结果列表","operationId":"execute_cypher_api_graph_query_execute_cypher_post","parameters":[{"name":"cypher_query","in":"query","required":true,"schema":{"type":"string","title":"Cypher Query"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Execute Cypher Api Graph Query Execute Cypher Post"}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/graph-query/schema":{"get":{"tags":["graph-query"],"summary":"获取图数据库模式","description":"获取当前Neo4j图数据库的模式信息\n\n返回:\n- **schema**: 格式化的图数据库模式字符串","operationId":"get_graph_schema_api_graph_query_schema_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","title":"Response Get Graph Schema Api Graph Query Schema Get"}}}},"404":{"description":"Not found"}}}},"/health":{"get":{"tags":["health"],"summary":"Health Check","description":"Health check endpoint","operationId":"health_check_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/system":{"get":{"tags":["system"],"summary":"System Info","description":"System information endpoint","operationId":"system_info_system_get","parameters":[{"name":"max_context_length","in":"query","required":false,"schema":{"type":"integer","default":4000,"title":"Max Context Length"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"AsyncTaskResponse":{"properties":{"task_id":{"type":"string","title":"Task Id","description":"Task identifier"},"status":{"type":"string","title":"Status","description":"Task status"}},"type":"object","required":["task_id","status"],"title":"AsyncTaskResponse","description":"Asynchronous task response model"},"Body_upload_document_api_documents_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"settings":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Settings"}},"type":"object","required":["file"],"title":"Body_upload_document_api_documents_post"},"ChatRequest":{"properties":{"messages":{"items":{"$ref":"#/components/schemas/Message"},"type":"array","title":"Messages","description":"Conversation history"},"settings":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Settings","description":"Optional chat settings"}},"type":"object","required":["messages"],"title":"ChatRequest","description":"Chat request model with conversation history"},"ChatResponse":{"properties":{"message":{"$ref":"#/components/schemas/Message","description":"Assistant's response message"},"sources":{"anyOf":[{"items":{"type":"object"},"type":"array"},{"type":"null"}],"title":"Sources","description":"Knowledge sources used"},"stats":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Stats","description":"Performance statistics"}},"type":"object","required":["message"],"title":"ChatResponse","description":"Chat response model"},"DocumentStats":{"properties":{"document_count":{"type":"integer","title":"Document Count","description":"Number of documents in the knowledge graph"},"entity_count":{"type":"integer","title":"Entity Count","description":"Number of entities in the knowledge graph"},"relationship_count":{"type":"integer","title":"Relationship Count","description":"Number of relationships in the knowledge graph"},"last_updated":{"type":"string","title":"Last Updated","description":"Last update timestamp"}},"type":"object","required":["document_count","entity_count","relationship_count","last_updated"],"title":"DocumentStats","description":"Document statistics model"},"GraphTaskResponse":{"properties":{"task_id":{"type":"string","title":"Task Id","description":"Task identifier"},"status":{"type":"string","title":"Status","description":"Task status"},"filename":{"type":"string","title":"Filename","description":"Uploaded filename"}},"type":"object","required":["task_id","status","filename"],"title":"GraphTaskResponse","description":"Asynchronous graph processing task response model"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"Message":{"properties":{"role":{"type":"string","title":"Role","description":"Message role (user, assistant, system)"},"content":{"type":"string","title":"Content","description":"Message content"}},"type":"object","required":["role","content"],"title":"Message","description":"Chat message model"},"Text2CypherRequest":{"properties":{"query":{"type":"string","title":"Query","description":"自然语言查询","example":"列出所有Person节点及其名称"},"return_direct":{"type":"boolean","title":"Return Direct","description":"是否直接返回数据库结果，而不经过LLM解释","default":false},"top_k":{"anyOf":[{"type":"integer","maximum":100.0,"minimum":1.0},{"type":"null"}],"title":"Top K","description":"返回结果的最大数量","default":10}},"type":"object","required":["query"],"title":"Text2CypherRequest","description":"自然语言到Cypher的查询请求"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}}}}